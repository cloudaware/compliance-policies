---
inputObject: CA10A1__CaAwsEksCluster__c
importExtracts:
  - file: /types/CA10A1__CaAwsEksCluster__c/breeze.extracts.yaml
testData:
  - file: ../test-data-ca10a1.json
conditions:
  - status: INCOMPLIANT
    currentStateMessage: Cluster never had breeze agent installed
    remediationMessage: Install breeze agent on the cluster
    condition:
      IS_EMPTY:
        arg:
          EXTRACT: breezeLastUpdate
  - status: INCOMPLIANT
    currentStateMessage: Cluster latest breeze report was more than a day ago
    remediationMessage: Re-install breeze agent on the cluster and make sure it is reporting
    condition:
      IS_BEYOND_LAST_DAYS:
        offsetDays: 1
        arg:
          EXTRACT: breezeLastUpdate
otherwise:
  status: COMPLIANT
  currentStateMessage: Cluster has breeze agent installed and has a recent report
